ğŸ’¡ SQL Problem Statement:
 ğŸ‘‰ Write a query to find the second highest salary. If the second salary does not exist, return NULL.

ğŸ”¹ First Attempt (using DENSE_RANK)
WITH salary_rnk AS (
  SELECT Salary, DENSE_RANK() OVER (ORDER BY Salary DESC) AS rnk
  FROM Employee
)
SELECT Salary
FROM salary_rnk
WHERE rnk = 2;

âœ… Works if a second salary exists.
 âŒ But if everyone has the same salary â†’ it returns 0 rows (empty result).

ğŸ”¹ Improved Solution (using MAX)
WITH salary_rnk AS (
  SELECT Salary, DENSE_RANK() OVER (ORDER BY Salary DESC) AS rnk
  FROM Employee
)
SELECT MAX(Salary) AS SecondHighest
FROM salary_rnk
WHERE rnk = 2;

âœ… Now the query always returns one row:
If second salary exists â†’ returns it.
If not â†’ returns NULL (instead of no rows).

ğŸ”‘ Key Learning
Aggregate functions like MAX(), MIN(), SUM(), AVG() always return one row.
If no match â†’ they return NULL (except COUNT() which returns 0).
